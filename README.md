## Библиотека обеспечения безопасности данных на основе эллиптических кривых

Пакет cryptoswitch реализует схему ECIES с выбором алгоритма шифрования (на вход подаются симметричные алгоритмы шифрования, такие как AES, TwoFish и т.д., и режим шифрования )

### ECIES

![Encryption](https://github.com/elizarpif/diploma-elliptic/blob/develop/assets/ecies_encryption.png)

![Decryption](https://github.com/elizarpif/diploma-elliptic/blob/develop/assets/ecies_decryption.png)

### Возможные алгоритмы (курсивом - не реализовано):
- **AES**
- **DES**
- _3DES (TripleDES)_
- _RC5_
- _Blowfish_
- **Twofish**
- **Camellia**
- _RC4_
- _SEAl_

```go
privKey, err := cryptoswitch.GenerateKey()
if err != nil {
    log.WithError(err).Error("can't generate private key")
    return err
}

cw := cryptoswitch.NewCryptoSwitch(cryptoswitch.AES, cryptoswitch.GCM)

encrypt, err := cw.Encrypt(privKey.PublicKey, []byte(testingMessage))
if err != nil {
    log.WithError(err).Error("can't encrypt aes")
    return err
}
```
### Шифры

#### Camellia
Сamellia - алгоритм симметричного блочного шифрования (размер блока 128 бит, ключ 128, 192, 256 бит), один из финалистов европейского конкурса NESSIE. Является дальнейшим развитием одного из алгоритмов, участвовавших в конкурсе AES. [17]
Структура алгоритма основана на классической цепи Фейстеля с предварительным и финальным забеливанием. Цикловая функция использует нелинейное преобразование S-блока, блок линейного рассеивания каждые 16 циклов, побайтовую операцию XOR и байтовую перестановку.

В зависимости от длины ключа имеет 18 циклов 128 разрядный ключ, либо 24 цикла 192 и 256 разрядный ключ. В программной реализации был выбран Camellia с размером блока в 128 бит и длиной ключа, равной 128 бит. 

#### Twofish
Twofish — симметричный алгоритм блочного шифрования с размером блока 128 бит и длиной ключа до 256 бит. Число раундов 16. Разработан группой специалистов во главе с Брюсом Шнайером. Являлся одним из пяти финалистов второго этапа конкурса AES. Алгоритм разработан на основе алгоритмов Blowfish, Safer и Square. [28]

Отличительными особенностями алгоритма являются использование предварительно вычисляемых и зависящих от ключа s-box-ов и сложная схема развёртки подключей шифрования. Половина n-битного ключа шифрования используется как ключ шифрования, другая — (от которой зависят s-box-ы) — для модификации алгоритма.

Twofish разрабатывался специально с учетом требований и рекомендаций для AES:

●     128-битный блочный симметричный шифр

●     Длина ключей 128, 192 и 256 бит

●     Отсутствие слабых ключей

●     Эффективная программная и аппаратная реализация

●     Гибкость (возможность использования дополнительных длин ключа, использование в поточном шифровании, хэш-функциях и т. д.)

●     Простота алгоритма 

В сравнении с Rijndael проигрывает в относительной сложности алгоритма и скорости выполнения на большинстве платформ.

Алгоритм Twofish реализован в виде смешанной сети Фейстеля с четырьмя ветвями, которые модифицируют друг друга с использованием криптопреобразования Адамара.

Алгоритм Twofish не запатентован и может быть использован кем угодно без какой-либо платы или отчислений. Он используется во многих программах шифрования, хотя и получил меньшее распространение, чем Blowfish.

### Возможные режимы шифрования:
- CBC
- GCM (работает только с шифрованием ключа 128 бит)

GCM – **Galois/Counter Mode** – режим счётчика с аутентификацией Галуа: это режим аутентифицированного шифрования, который, к тому же, поддерживает аутентификацию дополнительных данных (передаются в открытом виде). В англоязычной литературе это называется AEAD – Authenticated Encryption with Associated Data. В ГОСТовой криптографии такого режима как раз не хватает. Аутентифицированное шифрование позволяет обнаружить изменения сообщения до его расшифрования, для этого сообщение снабжается специальным кодом аутентификации (в русскоязычной традиции также называется имитовставкой). GCM позволяет защитить кодом аутентификации не только шифрованную часть сообщения, но и произвольные прикреплённые данные – это полезно, потому что в этих данных может быть записан, например, адрес получателя или другая открытая информация, которую, вместе с тем, требуется защитить от искажений/подмены.
